#!/bin/sh

APP_HOST=${APP_HOST:="localhost:8080"}
APP_BASE=${APP_BASE:="/sdn-todos/api/"}
APP_URL="http://${APP_HOST}${APP_BASE}"
REST_ENDPOINT="${APP_URL}todos"
CURL_OPTS="--verbose --fail -H Accept:application/json -H Content-Type:application/json"

list() {
  curl ${CURL_OPTS} ${REST_ENDPOINT}
}

make() {
  TITLE=$1
  curl -d "{ \"title\" :\"${TITLE}\"}" ${CURL_OPTS} ${REST_ENDPOINT} 
}

remove() {
  ID=$1
  REST_ENDPOINT="${REST_ENDPOINT}/${ID}"
  curl -X DELETE ${CURL_OPTS} ${REST_ENDPOINT} 
}

usage() {
  echo "Usage: $0 { list | mk | rm }"
}

if [ "$1" == "" ]; then
  usage
  exit 1
fi


case "$1" in
  list)
    list
    ;;

  mk)
    if [ "$2" == "" ]; then usage; echo "  mk \"text\""; exit 1; fi
    make "$2"
    ;;
  rm)
    if [ "$2" == "" ]; then usage; echo "  rm {id}"; exit 1; fi
    remove "$2"
    ;;
  *)
    usage
    ;;
esac
